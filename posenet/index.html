<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<!-- p5js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.0.0/p5.min.js"></script>
<!-- ml5 -->
<script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>
<script>
    let video;
    let poseNet;
    let pose;
    let skeleton;

    function setup() {
        createCanvas(640, 480);
        video = createCapture(VIDEO);
        video.hide();
        poseNet = ml5.poseNet(video, modelLoaded);
        poseNet.on("pose", gotPoses);
    }

    function gotPoses(poses) {
        // console.log(poses);
        if (poses.length > 0) {
            pose = poses[0].pose;
            skeleton = poses[0].skeleton;
        }
    }

    function modelLoaded() {
        console.log("model loaded");
    }

    function draw() {
        image(video, 0, 0);

        if (pose && skeleton) {
            for (const point of pose.keypoints) {
                const {x, y} = point.position;
                fill("red");
                circle(x, y, 10);
            }

            for (const connectionPoints of skeleton) {
                const {x: aX, y: aY} = connectionPoints[0].position;
                const {x: bX, y: bY} = connectionPoints[1].position;

                line(aX, aY, bX, bY);
            }
        }
    }
</script>
</body>
</html>